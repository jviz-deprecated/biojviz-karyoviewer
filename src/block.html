<!--
@license
Copyright (c) 2016 The Jviz Project Authors. All rights reserved.
The Jviz Project is under the MIT License. See https://github.com/jviz/jviz/blob/dev/LICENSE
-->
<script>

//Resize the block object
jviz_karyoviewer.__block_resize = function()
{
  //Get the number of chromosomes
  var num = this._chromosomes.num;

  //Calculate for landscape orientation
  if(this.is_landscape() === true)
  {
    //Get the default values for landscape
    var def = this._block.default.landscape;

    //Set the margins
    this._block.margin = { top: def.margin_top, bottom: def.margin_bottom, left: def.margin_left, right: def.margin_right };

    //Get the block draw width
    this._block.draw.width = this._width - this._block.margin.left - this._block.margin.right;

    //Get the block draw height
    this._block.draw.height = def.draw_height;
  }

  //Calculate for portrait orientation
  else
  {
    //Get the default values for portrait
    var def = this._block.default.portrait;

    //Set the margins
    this._block.margin = { top: def.margin_top, bottom: def.margin_bottom };

    //Set the margin left
    this._block.margin.left = (this._width - def.draw_width * num) / (2 * num);

    //Set the margin right
    this._block.margin.right = (this._width - def.draw_width * num) / (2 * num);

    //Get the block draw width
    this._block.draw.width = def.draw_width;

    //Get the block draw height
    this._block.draw.height = def.draw_height;
  }

  //Get the block width
  this._block.width = this._block.margin.left + this._block.margin.right + this._block.draw.width;

  //Get the block height
  this._block.height = this._block.margin.top + this._block.margin.bottom + this._block.draw.height;

  //Calculate the new canvas height
  this._height = (this.is_landscape() === true) ? this._block.height * num : this._block.height;

  //Set the canvas height
  this.karyoviewerHeight = this._height;

  //Set block resized
  this._block.resized = true;

  //Continue
  return this;
};

//Draw the block over
jviz_karyoviewer.__block_draw = function()
{
  //Check for no block to draw
  if(this._block.actual === this._over.block.actual){ return; }

  //Save this block
  this._block.actual = this._over.block.actual;

  //Get the canvas
  var canvas = this.$.canvas.get_layers()[this._block.layer];

  //Clear the block
  canvas.clear();

  //Check for no block to draw
  if(this._block.actual === false){ return; }

  //Check if is landscape
  if(this.is_landscape() === true)
  {
    //Get the block position x for landscape
    var block_posx = this._block.offset;

    //Get the block position y for landscape
    var block_posy = this._block.offset + this._block.actual * height;
  }
  else
  {
    //Get the block position x for portrait
    var block_posx = this._block.offset + this._block.actual * this._block.width;

    //Get the block position y for portrait
    var block_posy = this._block.offset;
  }

  //Get the block width
  var block_width = this._block.width - this._block.offset * 2;

  //Get the block height
  var block_height = this._block.height - this._block.offset * 2;

  //Draw the rectangle block
  canvas.rect({ x: block_posx, y: block_posy, width: block_width, height: block_height, radius: this._block.radius });

  //Fill the block
  canvas.fill({ color: this._block.color, opacity: this._block.opacity });

  //Continue
  return;
};

//Clear the block
jviz_karyoviewer.__block_clear = function()
{
  //Cleat the block layer
  this.$.canvas.get_layers()[this._block.layer].clear();
};

</script>